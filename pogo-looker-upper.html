<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
  <head>
    <title>Pokemon GO: Strength looker-upper</title>

    <script>
     /*
        The pokemon types and their weaknesses
      */
     const matrix  = {
       "normal"   : ["fighting"],
       "fighting" : ["flying","psychic","fairy"],
       "flying"   : ["rock","electric","ice"],
       "poison"   : ["ground","psychic"],
       "ground"   : ["water","grass","ice"],
       "rock"     : ["fighting","ground","steel","water","grass"],
       "bug"      : ["flying","rock","fire"],
       "ghost"    : ["ghost","dark"],
       "steel"    : ["fighting","ground","fire"],
       "fire"     : ["ground","rock","water"],
       "water"    : ["grass","electric"],
       "grass"    : ["flying","poison","bug","fire","ice"],
       "electric" : ["ground"],
       "psychic"  : ["bug","ghost","dark"],
       "ice"      : ["fighting","rock","steel","fire"],
       "dragon"   : ["ice","dragon","fairy"],
       "fairy"    : ["poison","steel"],
       "dark"     : ["fighting","bug","fairy"],

     };

     /*
        Helper function.
        Capitalises the first letter of a string.
      */
     function _uc (string) {
       return string.charAt(0).toUpperCase() + string.slice(1);
     }

     /*
        Given two types, returns pokemon type which will give 4x fighting
        strength. returns undef if it doesnt exist.
      */
     function getUltimateType (prim, seco) {
       const primArr = matrix[prim];
       const secoArr = matrix[seco];

       // filter() passes each element of primArr to a lambda.
       // If function returns false, said element is filtered away
       return  primArr.filter(
         // The fat arrow's the lambda, which takes one param known here as 'value'.
         value =>

           // includes() returns true if value exists
           // in the array.
           secoArr.includes(value));
     }

     /*
        Given an array of poketypes, returns a string you
        can paste into Pokemon GO's Pokemon search field.
      */
     function createSearchString (pokeArray) {
       var output = "";
       var arr = [];

       if (pokeArray.length === 0) {
         return "";
       }

       for (var t in pokeArray) {
         arr.push("@" + 1 + pokeArray[t]);
       }
       output = arr.join(',');

       arr = [];
       for (var t in pokeArray) {
         arr.push("@" + 2 + pokeArray[t]);
       }
       output += "&" + arr.join(',');

       return output;
     }


     /*
        Updates HTML entities for secondary poketype with data
      */
     function refresh () {
       var prim = document.getElementById("primaryType").innerHTML;
       var seco = document.getElementById("secondaryType").innerHTML;

       document.getElementById("primaryType2").innerHTML = _uc(prim);
       document.getElementById("secondaryType2").innerHTML = _uc(seco);


       if ("-" !== prim) {
         document.getElementById("primaryWeakness").innerHTML = matrix[prim];
         document.getElementById("primarySearch").innerHTML = createSearchString(matrix[prim]);
       } else {
         document.getElementById("primaryWeakness").innerHTML = "-";
         document.getElementById("primarySearch").innerHTML = "-";
       }
       if ("-" !== seco) {
         document.getElementById("secondaryWeakness").innerHTML = matrix[seco];
         document.getElementById("secondarySearch").innerHTML = createSearchString(matrix[seco]);
       } else {
         document.getElementById("secondaryWeakness").innerHTML = "-";
         document.getElementById("secondarySearch").innerHTML = "-";
       }
       if ("-" !== prim && "-" !== seco) {
         var types = getUltimateType(prim, seco);
         document.getElementById("ultimateType").innerHTML = types;
         document.getElementById("ultimateSearch").innerHTML = createSearchString(types);
       } else {
         document.getElementById("ultimateType").innerHTML = "-";
         document.getElementById("ultimateSearch").innerHTML = "-";
       }
     }

     /*
        Save primary type
      */
     function updatePrimary (poketype) {
       document.getElementById("primaryType").innerHTML = poketype;
       refresh();
     }
     /*
        Save secondary type
      */
     function updateSecondary (poketype) {
       document.getElementById("secondaryType").innerHTML = poketype;
       refresh();
     }

     /*
        Resets everything to initial state
      */
     function reset () {
       document.getElementById("primaryType").innerHTML = "-";
       document.getElementById("secondaryType").innerHTML = "-";
       document.getElementById("p_none").checked = true;
       document.getElementById("s_none").checked = true;

       refresh();
     }

    </script>
  </head>
  <body>
    <center><h1>Pokemon GO:<br/>Looker upper</h1></center>
    <div id="foo"></div>

    <table border="1" width="100%">

      <tr>
        <td width="50%" bgcolor="#88cc88">
          <h2>Primary type:</h2>
          <input type="radio" name="f" id="p_none" onclick=updatePrimary("-") checked>Nothing selected</input><br/>

          <input type="radio" name="f" onclick=updatePrimary("bug")      >Bug</input><br/>
          <input type="radio" name="f" onclick=updatePrimary("dark")     >Dark</input><br/>
          <input type="radio" name="f" onclick=updatePrimary("dragon")   >Dragon</input><br/>
          <input type="radio" name="f" onclick=updatePrimary("electric") >Electric</input><br/>
          <input type="radio" name="f" onclick=updatePrimary("fairy")    >Fairy</input><br/>
          <input type="radio" name="f" onclick=updatePrimary("fighting") >Fighting</input><br/>
          <input type="radio" name="f" onclick=updatePrimary("fire")     >Fire</input><br/>
          <input type="radio" name="f" onclick=updatePrimary("flying")   >Flying</input><br/>
          <input type="radio" name="f" onclick=updatePrimary("ghost")    >Ghost</input><br/>
          <input type="radio" name="f" onclick=updatePrimary("grass")    >Grass</input><br/>
          <input type="radio" name="f" onclick=updatePrimary("ground")   >Ground</input><br/>
          <input type="radio" name="f" onclick=updatePrimary("ice")      >Ice</input><br/>
          <input type="radio" name="f" onclick=updatePrimary("normal")   >Normal</input><br/>
          <input type="radio" name="f" onclick=updatePrimary("poison")   >Poison</input><br/>
          <input type="radio" name="f" onclick=updatePrimary("psychic")  >Psychic</input><br/>
          <input type="radio" name="f" onclick=updatePrimary("rock")     >Rock</input><br/>
          <input type="radio" name="f" onclick=updatePrimary("steel")    >Steel</input><br/>
          <input type="radio" name="f" onclick=updatePrimary("water")    >Water</input><br/>

          <p>
            <span id="primaryType2">-</span> is weak against:
            <b id="primaryWeakness">-</b>
          </p>

        </td>
        <td width="50%" bgcolor="#8888cc">
          <h2>Secondary type (optional):</h2>
          <input type="radio" name="g" id="s_none" onclick=updateSecondary("-") checked>Nothing selected</input><br/>

          <input type="radio" name="g" onclick=updateSecondary("bug")      >Bug</input><br/>
          <input type="radio" name="g" onclick=updateSecondary("dark")     >Dark</input><br/>
          <input type="radio" name="g" onclick=updateSecondary("dragon")   >Dragon</input><br/>
          <input type="radio" name="g" onclick=updateSecondary("electric") >Electric</input><br/>
          <input type="radio" name="g" onclick=updateSecondary("fairy")    >Fairy</input><br/>
          <input type="radio" name="g" onclick=updateSecondary("fighting") >Fighting</input><br/>
          <input type="radio" name="g" onclick=updateSecondary("fire")     >Fire</input><br/>
          <input type="radio" name="g" onclick=updateSecondary("flying")   >Flying</input><br/>
          <input type="radio" name="g" onclick=updateSecondary("ghost")    >Ghost</input><br/>
          <input type="radio" name="g" onclick=updateSecondary("grass")    >Grass</input><br/>
          <input type="radio" name="g" onclick=updateSecondary("ground")   >Ground</input><br/>
          <input type="radio" name="g" onclick=updateSecondary("ice")      >Ice</input><br/>
          <input type="radio" name="g" onclick=updateSecondary("normal")   >Normal</input><br/>
          <input type="radio" name="g" onclick=updateSecondary("poison")   >Poison</input><br/>
          <input type="radio" name="g" onclick=updateSecondary("psychic")  >Psychic</input><br/>
          <input type="radio" name="g" onclick=updateSecondary("rock")     >Rock</input><br/>
          <input type="radio" name="g" onclick=updateSecondary("steel")    >Steel</input><br/>
          <input type="radio" name="g" onclick=updateSecondary("water")    >Water</input><br/>


          <p>
            <span id="secondaryType2">-</span> is weak against:
            <b id="secondaryWeakness">-</b>
          </p>

        </td>
      </tr>

      <tr>
        <td colspan="2" height="70" valign="top" bgcolor="#88cc88">
          Search string to fight <b id="primaryType">-</b> type:
          <p id="primarySearch">-</p>
        </td>
      </tr>
      <tr>
        <td colspan="2" height="70" valign="top" bgcolor="#8888cc">
          Search string to fight <b id="secondaryType">-</b> type:
          <p id="secondarySearch">-</p>
        </td>
      </tr>

      <tr>
        <td colspan="2" height="70" valign="top" bgcolor="#cc8888">
          The ultimate pokemon attack(s) against these two poketypes are: <b id="ultimateType">-</b>.<br/>

          Your ultimate search string is:
          <p id="ultimateSearch">-</p>
        </td>
      </tr>
    </table>
    <p>
      <center>
        <button type="button" onclick="reset()">Reset!</button>
      </center>
    </p>

    <hr/>


    <p>
      So... when playing Pokemon GO, there's this situation which
      comes up every now and then - you're about to fight some
      pokemon, and you see it's a WATER type. The app suggests a
      team for you to enter the fray with, but often it's not a very
      strong team because it doesn't take the defender's weaknesses
      into consideration.
    </p>
    <p>
      What I normally do then is to google the defender's type, get
      to a web page with a zillion ads, scroll down lots and lots where I may or may not find a
      table where I look up the type. If it was type WATER, I find
      out that this pokemon is weak to Fire, Ground, and Rock
      attacks.
    </p>
    <p>
      Next, I re-open Pokemon GO, and search among my Pokemon for
      any which has moves which belong to one of he three
      attacks. PoGo has a weird search syntax, and I need to type
      the following:
    </p>
    <p>
      <code>  @1fire,@1ground,@1rock&@2fire,@2ground,@2rock</code>
    </p>
    <p>
      This is, needless to say, a major PITA.
    </p>
    <p>
      So I decided to write a little webpage which does the lookup for
      me (If you didn't notice, this is that webpage.) Along the way I
      even learned some (very basic) javascript.
    </p>
    <p>
      Happy Pogo-ing!<br/>
      fimblo
    </p>


  </body>
</html>
